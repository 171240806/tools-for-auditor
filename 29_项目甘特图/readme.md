## VBA画甘特图：项目管理工具

今天在项目上正吭哧、吭哧地干活，领导突然发来一个需要。

“啊，XXX，这个项目安排能不能画个甘特图，不用project软件，因为我们没钱嘛。能不能就用Excel画？，大概就是我刚截图给你的样子”

我一看，其实就是按日期排一列，然后根据项目时间给填充上对应时间。

然后就答应下来，用VBA写了下代码， 就有了本文所说的工具。

先放张最终效果示意图：


![](https://imgkr.cn-bj.ufileos.com/ff4da8cd-8c8d-4555-b91d-8150f0ef887d.png)

下面介绍下使用：

## 一、使用说明

在填写控制表前，我们先把你项目时间安排的数据直接复制粘贴到工作簿来，表名无所谓。

![](https://imgkr.cn-bj.ufileos.com/a1118643-f86c-4150-bcfe-e7620b193d7e.png)


![](https://imgkr.cn-bj.ufileos.com/c3a94631-6913-4c64-a929-560c2c5d515a.png)

然后我们填对应参数：

1. 数据表表名：比如我们存数据的表这里叫"Sheet1"
2. 开始时间列：就是Sheet1表中的预计开始时间所在的列，填B。
3. 结束时间列：同理填C。
4. 甘特图开始列：也就是我们从第几列开始画图。比如这里我挨着数据填，就写上D
5. 任务列：这个是针对一些关键字着不同颜色用的，比如A列是任务名称，我想不同的任务用不同的颜色。这里对A列筛选，就填A。
6. 普通任务颜色：设置普通的任务用什么颜色。
7. 特殊任务关键字和颜色：如果我想对A列中包含有某些特殊的任务着不同的颜色，就依次往下填写。

完成上述参数填写后，点击“画图”。

然后就生成结果：


![](https://imgkr.cn-bj.ufileos.com/639d2131-5b2e-45a5-b47e-d77a820de6b3.png)

